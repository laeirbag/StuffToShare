<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link href="bootstrap.css" rel="stylesheet">
		<script src="angular.min.js"></script>
		<style>
			tr
			{
				-webkit-touch-callout : none;
				-webkit-user-select   : none;
				-khtml-user-select    : none;
				-moz-user-select      : none;
				-ms-user-select       : none;
				user-select           : none;
			}

			.slot
			{
				border : 1px solid #000000;
			}

			.cell
			{
				width  : 75px;
				height : 25px;
			}

			.number
			{
				text-align : right;
			}

			.task
			{
				background : #1166FF;
			}
		</style>
		<script>
			angular
				.module("gantt",[])
				.controller
				(
					"planning",
					function($scope)
					{
						var start            = 1;
						var end              = 100;
						$scope.dragPoint    = null;
						$scope.currentTask = null;

						$scope.slots = [];

						$scope.dragStart = function(index, point)
						{
							$scope.dragPoint   = point;
							$scope.currentTask = $scope.tasks[index];

							$scope.currentTask.drag=
							{
								start : $scope.currentTask.current.start,
								end   : $scope.currentTask.current.end
							};
						};

						$scope.dragEnd = function(point)
						{
							$scope.dragPoint   = null;
							$scope.currentRask = null;
						};

						$scope.tasks=
						[{
							name  : "Tarea",
							original:
							{
								start : 27,
								end   : 45
							},
							current:
							{
								start : 27,
								end   : 45
							}
						}];

						$scope.moveTask = function(point)
						{
							var diff                           = point - $scope.dragPoint;
							$scope.currentTask.current.start=
								$scope.currentTask.drag.start + diff;

							$scope.currentTask.current.end=
								$scope.currentTask.drag.end + diff;
						};

						for(let i = start; i <= end; i++)
						{
							$scope.slots.push(i);
						}
					}
				);
		</script>
	</head>
	<body ng-app="gantt" ng-controller="planning">
		<div>
			<table>
				<tbody>
					<tr>
						<th class="slot">
							#
						</th>
						<th ng-repeat="slot in slots" class="slot">
							<div class="number cell"  ng-mouseover="dragPoint && moveTask(slot)" ng-mouseup="dragEnd()">
								{{slot}}
							</div>
						</th>
					</tr>
					<tr ng-repeat="task in tasks">
						<th class="slot">
							{{task.name}}
						</th>
						<th ng-repeat="slot in slots" class="slot">
							<div class="cell" ng-class="(slot >= task.current.start && slot <= task.current.end) && 'task'"
							  ng-mousedown="dragStart($parent.$index, slot)" ng-mouseover="dragPoint && moveTask(slot)"
							  ng-mouseup="dragEnd()"
							>
							</div>
						</th>
					</tr>
				</tbody>
			</table>
		</div>
	</body>
</html>
